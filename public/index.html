<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØªØ¬Ø± Ø¹Ù„ÙŠ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</title>
    <style>
        :root { --gold: #d4af37; --dark: #121212; --card: #1e1e1e; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--dark); color: white; padding: 20px; }
        .container { max-width: 600px; margin: auto; }
        header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid var(--gold); padding-bottom: 20px; }
        .admin-box { background: var(--card); border: 1px solid var(--gold); padding: 20px; border-radius: 15px; margin-bottom: 20px; display: none; }
        .input-style { width: 95%; padding: 10px; margin: 5px 0; border-radius: 8px; background: #111; color: white; border: 1px solid #333; }
        .app-card { background: var(--card); padding: 15px; border-radius: 15px; margin-bottom: 15px; display: flex; align-items: center; gap: 15px; border-right: 5px solid var(--gold); position: relative; }
        .app-icon { width: 65px; height: 65px; border-radius: 12px; object-fit: cover; border: 1px solid #333; }
        .app-info { flex-grow: 1; }
        .app-info h4 { margin: 0; color: var(--gold); font-size: 18px; }
        .app-info p { margin: 5px 0 0; font-size: 13px; color: #aaa; }
        .btn-download { background: var(--gold); color: black; text-decoration: none; padding: 10px 20px; border-radius: 10px; font-weight: bold; }
        .btn-admin { background: none; border: 1px solid #444; color: #888; cursor: pointer; padding: 8px; border-radius: 8px; margin-bottom: 20px; width: 100%; }
        .delete-form { margin-top: 10px; display: none; } /* ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ø¹Ù†Ø¯ ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© */
        .btn-delete { background: #ff4444; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 11px; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>âœ¨ Ù…ØªØ¬Ø± ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¹Ù„ÙŠ âœ¨</h1>
            <button class="btn-admin" onclick="toggleAdmin()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø§Ù„Ùƒ âš™ï¸</button>
        </header>

        <div id="adminPanel" class="admin-box">
            <form action="/upload" method="POST" enctype="multipart/form-data">
                <input type="password" name="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù„Ù„Ù…Ø§Ù„Ùƒ" class="input-style" required>
                <input type="text" name="appName" placeholder="Ø§Ø³Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚" class="input-style" required>
                <textarea name="description" placeholder="ÙˆØµÙ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚" class="input-style"></textarea>
                <input type="text" name="imageUrl" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© (Image URL)" class="input-style">
                <input type="file" name="apkFile" accept=".apk" class="input-style" required>
                <button type="submit" style="width:100%; background:var(--gold); padding:12px; border:none; border-radius:10px; font-weight:bold; cursor:pointer; margin-top:10px">ğŸš€ Ù†Ø´Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</button>
            </form>
        </div>

        <div id="appsList">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª...</div>
    </div>

    <script>
        let adminMode = false;

        function toggleAdmin() {
            adminMode = !adminMode;
            document.getElementById('adminPanel').style.display = adminMode ? 'block' : 'none';
            loadApps(); // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø­Ø°Ù
        }

        async function loadApps() {
            const res = await fetch('/list-apps');
            const apps = await res.json();
            const list = document.getElementById('appsList');
            list.innerHTML = '';
            
            if(apps.length === 0) {
                list.innerHTML = '<p style="text-align:center; color:#666;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</p>';
                return;
            }

            apps.forEach(app => {
                list.innerHTML += `
                    <div class="app-card">
                        <img src="${app.img}" class="app-icon" onerror="this.src='https://cdn-icons-png.flaticon.com/512/2522/2522649.png'">
                        <div class="app-info">
                            <h4>${app.name}</h4>
                            <p>${app.desc || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ'}</p>
                            ${adminMode ? `
                                <form action="/delete-app" method="POST" class="delete-form" style="display:block">
                                    <input type="hidden" name="appId" value="${app.id}">
                                    <input type="password" name="password" placeholder="Ø³Ø± Ø§Ù„Ø­Ø°Ù" style="width:70px; font-size:10px; background:#000; color:#fff; border:1px solid var(--gold)">
                                    <button type="submit" class="btn-delete">Ø­Ø°Ù ğŸ—‘ï¸</button>
                                </form>
                            ` : ''}
                        </div>
                        <a href="${app.url}" class="btn-download" download>ØªØ­Ù…ÙŠÙ„</a>
                    </div>`;
            });
        }
        loadApps();
    </script>
</body>
</html>
